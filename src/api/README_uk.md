# GlobalScope MultiFrame 11.0 API

## Огляд

*Документація також доступна англійською мовою: [README.md](README.md)*

*Дивіться [політику мови](../../docs/language_policy_uk.md) для отримання додаткової інформації про мовні версії.*

## Огляд
Ця директорія містить реалізацію API для платформи проектування мікросхем GlobalScope MultiFrame 11.0. API побудовано за допомогою FastAPI та надає RESTful ендпоінти для всієї функціональності системи.

## Структура директорії
```
src/api/
├── __init__.py          # Ініціалізація пакету
├── main_app.py          # Основний додаток FastAPI
├── api_config.py        # Реєстрація роутерів API
├── routers.py           # Всі ендпоінти API, організовані за функціональністю
└── README.md            # Цей файл
```

## Ключові файли

### main_app.py
Основний додаток FastAPI, який слугує точкою входу для API. Він:
- Створює екземпляр додатку FastAPI
- Налаштовує проміжне програмне забезпечення (CORS тощо)
- Реєструє всі роутери API
- Обробляє події запуску та завершення роботи

### api_config.py
Містить функцію `register_routers`, яка реєструє всі роутери API з основним додатком. Це забезпечує централізоване керування роутерами.

### routers.py
Містить всі ендпоінти API, організовані за функціональними областями:
- Керування системою
- Автентифікація
- Проектування мікросхем
- Аналітика
- Безпека
- Моделювання
- Співпраця
- Спільнота
- Маркетплейс
- Інтеграція
- Адміністрування

## Функціональні області

Кожна функціональна область має власний роутер з відповідними тегами та префіксами:

1. **Система** (`/system`) - Кореневий ендпоінт та керування режимом системи
2. **Автентифікація** (`/auth`) - Вхід/вихід користувача
3. **Проектування мікросхем** (`/chip`) - Створення процесів мікросхем та інженерія без дефектів
4. **Аналітика** (`/analytics`) - Метрики мікросхем та аналіз тенденцій
5. **Безпека** (`/security`) - Моніторинг загроз та захист від загроз нульового дня
6. **Генерація хешів** (`/hash`) - Генерація RTL хешів
7. **Квантове моделювання** (`/simulate/quantum`) - Квантові моделювання Монте-Карло
8. **Співпраця** (`/chip/collaboration`) - Функції сімейної співпраці
9. **Генерація драйверів** (`/chip/driver`) - Генерація драйверів мікросхем
10. **Голосові команди** (`/voice`) - Проектування мікросхем на основі голосу
11. **Інтерфейс BCI** (`/bci`) - Команди інтерфейсу мозок-комп'ютер
12. **Спільнота** (`/community`) - Функціональність форуму та чату
13. **Мережа дизайнерів** (`/designer`) - Реєстрація та підключення дизайнерів
14. **Виробництво** (`/fab`) - Аналітика виробництва
15. **Сервіси ШІ** (`/ai`) - Аналіз тенденцій ШІ та прогнозування стратегії
16. **Автоматичне масштабування** (`/auto/scale`) - Автоматичне масштабування ресурсів
17. **VR-тренування** (`/vr/training`) - Тренування у віртуальній реальності
18. **Генерація IP-блоків** (`/ip/block`) - Створення та керування IP-блоками
19. **Маркетплейс** (`/marketplace`) - Торгівля IP-блоками та навчальні квести
20. **Голосування DAO** (`/dao`) - Голосування децентралізованої автономної організації
21. **Інтеграція IoT** (`/iot`) - Інтеграція інтернету речей
22. **Інтеграція Web3** (`/web3`) - Створення та передача NFT
23. **Захист від нульового дня** (`/zero/day`) - Захист від вразливостей нульового дня
24. **Партнерська програма** (`/partner`) - Реєстрація та керування партнерами
25. **Моніторинг тендерів** (`/tender`) - Моніторинг тендерів
26. **Адміністративна панель** (`/admin`) - Функції адміністрування
27. **Перевірка здоров'я** (`/health`) - Моніторинг здоров'я системи

## Ендпоінти WebSocket

### AR WebSocket (`/ws/ar`)
Комунікація в реальному часі для AR-сповіщень та оновлень.

## Використання

### Запуск сервера API
```bash
uvicorn src.api.main_app:app --host 0.0.0.0 --port 8000
```

### Документація API
Після запуску сервера документація API доступна за адресами:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## Тестування

### Запуск тестів
```bash
python -m pytest tests/test_api.py
```

## Розширення API

### Додавання нових ендпоінтів
1. Додайте нові функції ендпоінтів до `routers.py` у відповідному роутері
2. Якщо створюєте нову функціональну область, створіть новий роутер
3. Зареєструйте новий роутер у `api_config.py`

### Додавання нових функціональних областей
1. Створіть новий роутер у `routers.py`
2. Додайте роутер до імпортів у `api_config.py`
3. Зареєструйте роутер у функції `register_routers`

## Принципи проектування

1. **Розділення обов'язків** - Кожна функціональна область ізольована
2. **Узгоджена обробка помилок** - Стандартизований формат відповідей про помилки
3. **Типова безпека** - Моделі Pydantic для валідації запитів/відповідей
4. **Документація** - Анотації OpenAPI/Swagger для всіх ендпоінтів
5. **Асинхронна обробка** - Всі ендпоінти асинхронні для максимальної пропускної здатності
6. **Архітектура, керована подіями** - Децентралізоване спілкування через шину подій

## Безпека

1. **Автентифікація** - Автентифікація на основі токенів для захищених ендпоінтів
2. **Валідація вхідних даних** - Моделі Pydantic перевіряють всі вхідні дані
3. **Обмеження швидкості** - Вбудоване обмеження швидкості для запобігання зловживанням
4. **CORS** - Налаштовано для дозволу лише довірених джерел

## Продуктивність

1. **Асинхронна обробка** - Неблокуючий ввід/вивід для максимальної пропускної здатності
2. **Пулинг з'єднань** - Ефективні з'єднання з базою даних та сервісами
3. **Кешування** - Відповідне кешування для покращення продуктивності

## База даних

Система використовує Redis як основне сховище даних з наступними ключовими патернами:

- `user:*` - Профілі користувачів та дані автентифікації
- `driver:*` - Згенеровані драйвери мікросхем
- `collab:*` - Сесії співпраці
- `process:*` - Процеси проектування мікросхем
- `nft:*` - Записи Web3 NFT
- `quest:*` - Навчальні квести
- `config:*` - Конфігурація системи
- `analytics:*` - Метрики продуктивності

Лічильники для генерації унікальних ID:
- `driver_counter`
- `collab_counter`
- `process_counter`
- `quest_counter`
- `nft_counter`

## Демонстраційні дані

Для ініціалізації бази даних демонстраційними даними для тестування:

```bash
python init_demo_data.py
```

Для перевірки правильного завантаження демонстраційних даних:

```bash
python verify_demo_data.py
```

## Моніторинг

1. **Перевірки здоров'я** - Ендпоінт `/health/` для статусу системи
2. **Логування** - Вичерпне логування для налагодження та аудиту
3. **Метрики** - Збір метрик продуктивності